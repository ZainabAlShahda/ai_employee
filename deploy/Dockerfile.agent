FROM python:3.13-slim

WORKDIR /app

# Install uv
RUN pip install --no-cache-dir uv

# Copy dependency files first for layer caching
COPY pyproject.toml uv.lock* ./

# Install dependencies (frozen â€” no network resolution at runtime)
RUN uv sync --frozen

# Copy application source
COPY . .

# Vault mount point (override VAULT_PATH via env)
ENV VAULT_PATH=/vault

CMD ["uv", "run", "python", "health/monitor.py"]
